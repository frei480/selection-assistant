# ๐ฏ Selection Assistant - ะะฝัะตะณัะฐัะธั SelectionService ะธะท Cherry Studio

## โ ะงัะพ ะฑัะปะพ ัะดะตะปะฐะฝะพ

### 1. **ะฃััะฐะฝะพะฒะปะตะฝะฐ ะทะฐะฒะธัะธะผะพััั**
   - `selection-hook` - ะฑะธะฑะปะธะพัะตะบะฐ ะดะปั ะณะปะพะฑะฐะปัะฝะพะณะพ ะพะฑะฝะฐััะถะตะฝะธั ะฒัะดะตะปะตะฝะธั ัะตะบััะฐ

### 2. **ะกะพะทะดะฐะฝ SelectionService** (`src/main/services/SelectionService.ts`)
   - Singleton ะบะปะฐัั ะดะปั ัะฟัะฐะฒะปะตะฝะธั ะพะฑะฝะฐััะถะตะฝะธะตะผ ัะตะบััะฐ
   - ะะพะดะดะตัะถะบะฐ Windows ะธ macOS
   - ะขัะธ ัะตะถะธะผะฐ ััะธะณะณะตัะฐ: Selection, Ctrlkey, Shortcut
   - ะฃะฟัะฐะฒะปะตะฝะธะต ะฒัะฟะปัะฒะฐััะตะน ะฟะฐะฝะตะปัั ะธ ะพะบะฝะฐะผะธ ัะตะทัะปััะฐัะพะฒ
   - IPC ะพะฑัะฐะฑะพััะธะบะธ ะดะปั ะฒะทะฐะธะผะพะดะตะนััะฒะธั ั renderer ะฟัะพัะตััะพะผ

### 3. **ะะฑะฝะพะฒะปะตะฝ ConfigManager**
   - ะกะพััะฐะฝะตะฝะธะต ะฝะฐัััะพะตะบ Selection Assistant
   - ะะพะดะดะตัะถะบะฐ LM Studio ะบะพะฝัะธะณััะฐัะธะธ
   - ะะพะดะฟะธัะบะฐ ะฝะฐ ะธะทะผะตะฝะตะฝะธั ะฟะฐัะฐะผะตััะพะฒ

### 4. **ะะฑะฝะพะฒะปะตะฝะฐ ัะธััะตะผะฐ IPC** (`src/shared/ipcChannels.ts`)
   - ะะฐะฝะฐะปั ะดะปั Selection: ัะตะบัั, ะฒะธะดะธะผะพััั, ัะฐะทะผะตั, ะดะตะนััะฒะธั
   - ะะฑัะฐะฑะพัะบะฐ ะพะบะพะฝ ัะตะทัะปััะฐัะพะฒ

### 5. **ะะฑะฝะพะฒะปะตะฝ Preload** (`src/main/preload.ts`)
   - API ะดะปั ะฒะทะฐะธะผะพะดะตะนััะฒะธั ั Selection Service
   - ะะตัะพะดั ะดะปั ัะฟัะฐะฒะปะตะฝะธั toolbar ะธ ัะตะทัะปััะฐัะพะฒ

### 6. **ะกะพะทะดะฐะฝะฐ UI ะดะปั Selection**
   - `src/renderer/components/SelectionWidget.tsx` - ะฒะธะดะถะตั ะฒัะฑะพัะฐ ะดะตะนััะฒะธะน
   - `src/renderer/selection-toolbar.tsx` - ัะพัะบะฐ ะฒัะพะดะฐ ะดะปั toolbar
   - `src/renderer/result-window.tsx` - ะพะบะฝะพ ัะตะทัะปััะฐัะพะฒ

### 7. **ะะฑะฝะพะฒะปะตะฝะฐ SettingsPage** (`src/renderer/pages/SettingsPage.tsx`)
   - ะะฐัะฐะผะตััั ะฟะพะดะบะปััะตะฝะธั ะบ LM Studio
   - ะขะตััะธัะพะฒะฐะฝะธะต ัะพะตะดะธะฝะตะฝะธั
   - ะัะฑะพั ะผะพะดะตะปะธ

### 8. **ะะฝัะตะณัะธัะพะฒะฐะฝ ะฒ Main Process** (`src/main/index.ts`)
   - ะะฝะธัะธะฐะปะธะทะฐัะธั SelectionService ะฟัะธ ะทะฐะฟััะบะต
   - Cleanup ะฟัะธ ะฒััะพะดะต ะฟัะธะปะพะถะตะฝะธั

### 9. **ะะฑะฝะพะฒะปะตะฝะฐ ะบะพะฝัะธะณััะฐัะธั Vite**
   - ะะพะดะดะตัะถะบะฐ ะฝะตัะบะพะปัะบะธั entry points
   - HTML ัะฐะนะปั ะดะปั toolbar ะธ ัะตะทัะปััะฐัะพะฒ

## ๐ ะัััััะน ััะฐัั

```bash
# ะฃััะฐะฝะพะฒะธัั ะทะฐะฒะธัะธะผะพััะธ
npm install

# ะะฐะฟัััะธัั ะฒ ัะตะถะธะผะต ัะฐะทัะฐะฑะพัะบะธ
npm run dev

# ะะปะธ ัะพะฑัะฐัั ะดะปั ะฟัะพะดะฐะบัะตะฝะฐ
npm run build
npm start
```

## โ๏ธ ะะพะฝัะธะณััะฐัะธั LM Studio

1. ะัะบัะพะนัะต LM Studio ะธ ะทะฐะณััะทะธัะต ะผะพะดะตะปั
2. ะะฐะฟัััะธัะต ะปะพะบะฐะปัะฝัะน ัะตัะฒะตั (ะพะฑััะฝะพ ะฝะฐ localhost:1234)
3. ะ ะฟัะธะปะพะถะตะฝะธะธ ะพัะบัะพะนัะต Settings
4. ะะฒะตะดะธัะต ะฟะฐัะฐะผะตััั ะฟะพะดะบะปััะตะฝะธั:
   - Host: `localhost`
   - Port: `1234`
   - API Path: `/v1`
   - Model: ะฒัะฑะตัะธัะต ะธะท ัะฟะธัะบะฐ
5. ะะฐะถะผะธัะต "Test Connection" ะดะปั ะฟัะพะฒะตัะบะธ

## ๐ ะะพะดะดะตัะถะธะฒะฐะตะผัะต ะดะตะนััะฒะธั

ะัะธ ะฒัะดะตะปะตะฝะธะธ ัะตะบััะฐ ะฟะพัะฒะปัะตััั ะฟะฐะฝะตะปั ั ะบะฝะพะฟะบะฐะผะธ:

- **Copy** - ะบะพะฟะธัะพะฒะฐัั ัะตะบัั ะฒ ะฑััะตั ะพะฑะผะตะฝะฐ
- **Explain** - ะพะฑัััะฝะธัั ัะตะบัั ั ะฟะพะผะพััั LM Studio
- **Summarize** - ัะพะทะดะฐัั ะบัะฐัะบะพะต ัะตะทัะผะต
- **Translate** - ะฟะตัะตะฒะตััะธ ัะตะบัั

## ๐ ะะปััะตะฒัะต ัะฐะนะปั

| ะคะฐะนะป | ะะฟะธัะฐะฝะธะต |
|------|---------|
| `src/main/services/SelectionService.ts` | ะัะฝะพะฒะฝะพะน ัะตัะฒะธั ะพะฑะฝะฐััะถะตะฝะธั ัะตะบััะฐ |
| `src/main/services/ConfigManager.ts` | ะฃะฟัะฐะฒะปะตะฝะธะต ะฝะฐัััะพะนะบะฐะผะธ |
| `src/main/preload.ts` | IPC API ะดะปั renderer |
| `src/renderer/selection-toolbar.tsx` | ะัะฟะปัะฒะฐััะธะน toolbar |
| `src/renderer/result-window.tsx` | ะะบะฝะพ ัะตะทัะปััะฐัะพะฒ |
| `src/shared/ipcChannels.ts` | ะะฟัะตะดะตะปะตะฝะธะต IPC ะบะฐะฝะฐะปะพะฒ |
| `src/shared/types.ts` | TypeScript ะธะฝัะตััะตะนัั |

## ๐๏ธ ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ   Selection Hook (system level)     โ
โ  ะพะฑะฝะฐััะถะธะฒะฐะตั ะฒัะดะตะปะตะฝะธะต ัะตะบััะฐ      โ
โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโ
               โ
               โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ     SelectionService (Main)         โ
โ  - ัะฟัะฐะฒะปะตะฝะธะต toolbar               โ
โ  - ัะฟัะฐะฒะปะตะฝะธะต action windows        โ
โ  - IPC ะพะฑัะฐะฑะพััะธะบะธ                  โ
โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโ
               โ
       โโโโโโโโโดโโโโโโโโโ
       โ                โ
       โผ                โผ
โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ
โSelectionBar  โ  โ ResultWindow โ
โ  (Renderer)  โ  โ  (Renderer)  โ
โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ
       โ                โ
       โโโโโฌโโโโโโโโโฌโโโโ
           โ        โ
           โผ        โผ
      LM Studio API
```

## ๐ ะงัะพ ะธะทััะตะฝะพ ะธะท Cherry Studio

ะะดะฐะฟัะธัะพะฒะฐะฝะฐ ะฐััะธัะตะบัััะฐ ะดะปั:
- ะะปะพะฑะฐะปัะฝะพะณะพ ะพะฑะฝะฐััะถะตะฝะธั ัะตะบััะฐ ัะตัะตะท `selection-hook`
- ะฃะฟัะฐะฒะปะตะฝะธั ะฒัะฟะปัะฒะฐััะตะน ะฟะฐะฝะตะปัั (toolbar)
- ะะพะทะธัะธะพะฝะธัะพะฒะฐะฝะธั ะพะบะพะฝ ัะตะทัะปััะฐัะพะฒ
- ะัะปะธัะพะฒะฐะฝะธะต ะพะบะพะฝ ัะตะทัะปััะฐัะพะฒ ะดะปั ะฑััััะพะณะพ ะฟะพะบะฐะทะฐ
- ะะฐะฑะพัะฐ ั Accessibility API ะฝะฐ macOS
- ะฃะฟัะฐะฒะปะตะฝะธะต ัะพะบััะพะผ ะพะบะฝะฐ (ะพัะพะฑัะต ััะตะฑะพะฒะฐะฝะธั macOS)

## ๐ ะัะธะผะตัะฐะฝะธั

- ะะฐ macOS ััะตะฑัะตััั ัะฐะทัะตัะตะฝะธะต Accessibility (System Preferences โ Security & Privacy โ Accessibility)
- Windows ััะตะฑัะตั admin ะฟัะฐะฒะฐ ะดะปั ะฟะตัะตัะฒะฐัะฐ ะณะปะพะฑะฐะปัะฝัั ัะพะฑััะธะน ะบะปะฐะฒะธะฐัััั
- LM Studio ะดะพะปะถะตะฝ ะฑััั ะทะฐะฟััะตะฝ ะธ ะธะผะตัั ะทะฐะณััะถะตะฝะฝัั ะผะพะดะตะปั
- ะกะพััะฐะฝะตะฝะธะต ะฝะฐัััะพะตะบ ะธัะฟะพะปัะทัะตั electron-store

## โจ ะะพะฟะพะปะฝะธัะตะปัะฝัะต ะฒะพะทะผะพะถะฝะพััะธ ะดะปั ัะฐััะธัะตะฝะธั

1. **ะะพะฑะฐะฒะธัั ะฑะพะปััะต ะดะตะนััะฒะธะน** - ะปะตะณะบะพ ะดะพะฑะฐะฒะธัั ะฝะพะฒัะต ะพะฑัะฐะฑะพััะธะบะธ
2. **ะะตััะพะฝะฐะปะธะทะธัะพะฒะฐะฝะฝัะต ะฟัะพะผะฟัั** - ัะพััะฐะฝะตะฝะธะต ะฟะพะปัะทะพะฒะฐัะตะปััะบะธั ัะฐะฑะปะพะฝะพะฒ
3. **ะััะพัะธั** - ัะพััะฐะฝะตะฝะธะต ะฟัะตะดัะดััะธั ัะตะทัะปััะฐัะพะฒ
4. **ะะพัััะธะต ะบะปะฐะฒะธัะธ** - ะณะปะพะฑะฐะปัะฝัะต ะบะพะผะฑะธะฝะฐัะธะธ ะดะปั ะฑััััะพะณะพ ะดะพัััะฟะฐ
5. **ะขะตะพัะตัะธัะตัะบะธ ะฒะพะทะผะพะถะฝะฐ ะฟะพะดะดะตัะถะบะฐ Linux** - ะฟัะธ ะฝะฐะปะธัะธะธ ัะบะฒะธะฒะฐะปะตะฝัะฐ selection-hook

## ๐ ะะตัะตะฝะธะต ะฟัะพะฑะปะตะผ

**SelectionService ะฝะต ะธะฝะธัะธะฐะปะธะทะธััะตััั:**
- ะัะพะฒะตัััะต, ััะพ `selection-hook` ัััะฐะฝะพะฒะปะตะฝะฐ
- ะะฐ macOS ะฟัะพะฒะตัััะต ัะฐะทัะตัะตะฝะธะต Accessibility
- ะะพัะผะพััะธัะต ะปะพะณะธ ะฒ dev tools (F12)

**Toolbar ะฝะต ะฟะพัะฒะปัะตััั:**
- ะฃะฑะตะดะธัะตัั, ััะพ LM Studio ะทะฐะฟััะตะฝ
- ะัะพะฒะตัััะต ะฒ Settings ััะพ Selection Assistant ะฒะบะปััะตะฝ
- ะะพะฟัะพะฑัะนัะต ะฟะตัะตะทะฐะณััะทะธัั ะฟัะธะปะพะถะตะฝะธะต

**LM Studio ะฝะต ะฟะพะดะบะปััะฐะตััั:**
- ะัะพะฒะตัััะต ััะพ ัะตัะฒะตั LM Studio ะทะฐะฟััะตะฝ
- ะัะฟะพะปัะทัะนัะต "Test Connection" ะฒ Settings
- ะัะพะฒะตัััะต ะฟะฐัะฐะผะตััั Host ะธ Port
